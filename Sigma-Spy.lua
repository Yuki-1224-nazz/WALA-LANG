local b={
...}local c=b[1]if typeof(c)=='table'then for d,e in c do a[d]=e end end local d
=setmetatable({},{__index=function(d,e)local f=game:GetService(e)return
cloneref(f)end})local e=(function()local e,f={UseWorkspace=false,Folder=
'Sigma spy',RepoUrl=nil,FolderStructure={['Sigma Spy']={'assets'}}}function e:
Init(g)local h,i=self.FolderStructure,g.Services f=i.HttpService self:
CheckFolders(h)end function e:PushConfig(g)for h,i in next,g do self[h]=i end
end function e:UrlFetch(g)local h={Url=g:gsub(' ','%%20'),Method='GET'}local i,j
=pcall(request,h)if not i then warn'[!] HTTP request error! Check console (F9)'
warn('> Url:',g)error(j)return''end local k,l=j.Body,j.StatusCode if l==404 then
warn'[!] The file requested has moved or been deleted.'warn(' >',g)return''end
return k,j end function e:MakePath(g)local h=self.Folder return`{h}/{g}`end
function e:LoadCustomasset(g)if not getcustomasset then return end if not g then
return end local h=readfile(g)if#h<=0 then return end local i,j=pcall(
getcustomasset,g)if not i then return end if not j or#j<=0 then return end
return j end function e:GetFile(g,h)local i,j,k,l=self.RepoUrl,self.UseWorkspace
,self:MakePath(g),''if j then l=readfile(k)else l=self:UrlFetch(`{i}/{g}`)end if
h then self:FileCheck(k,function()return l end)return self:LoadCustomasset(k)end
return l end function e:GetTemplate(g)return self:GetFile(`templates/{g}.lua`)
end function e:FileCheck(g,h)if isfile(g)then return end local i=h()writefile(g,
i)end function e:FolderCheck(g)if isfolder(g)then return end makefolder(g)end
function e:CheckPath(g,h)return g and`{g}/{h}`or h end function e:CheckFolders(g
,h)for i,j in next,g do if typeof(j)=='table'then local k=self:CheckPath(h,i)
self:FolderCheck(k)self:CheckFolders(j,k)continue end local k=self:CheckPath(h,j
)self:FolderCheck(k)end end function e:TemplateCheck(g,h)self:FileCheck(g,
function()return self:GetTemplate(h)end)end function e:GetAsset(g,h)return self:
GetFile(`assets/{g}`,h)end function e:GetModule(g,h)local i=`{g}.lua`if h then
self:TemplateCheck(i,h)local j=readfile(i)local k=loadstring(j)if k then return
j end return self:GetTemplate(h)end return self:GetFile(i)end function e:
LoadLibraries(g,...)local h={}for i,j in next,g do local k=typeof(j)=='table'and
j[1]=='base64'j=k and j[2]or j if typeof(j)~='string'and not k then h[i]=j
continue end if k then j=crypt.base64decode(j)g[i]=j end local l,m=loadstring(j,
i)assert(l,`Failed to load {i}: {m}`)h[i]=l(...)end return h end function e:
LoadModules(g,h)for i,j in next,g do local k=j.Init if not k then continue end j
:Init(h)end end function e:CreateFont(g,h)if not h then return end local i=`assets/{
g}.json`local j,k=self:MakePath(i),{name=g,faces={{name='Regular',weight=400,
style='Normal',assetId=h}}}local l=f:JSONEncode(k)writefile(j,l)return j end
function e:CompileModule(g)local h='local Libraries = {'for i,j in g do if
typeof(j)~='string'then continue end h..=`\t{i} = (function()\n{j}\nend)(),\n`
end h..='}'return h end function e:MakeActorScript(g,h)local i=e:CompileModule(g
)i..='\r\n\tlocal ExtraData = {\r\n\t\tIsActor = true\r\n\t}\r\n\t'i..=`Libraries.Hook:BeginService(Libraries, ExtraData, {
h})`return i end return e end)()e:PushConfig(a)e:Init{Services=d}local f=e.
FolderName local g,h={Config=e:GetModule(`{f}/Config`,'Config'),ReturnSpoofs=e:
GetModule(`{f}/Return spoofs`,'Return Spoofs'),Configuration=a,Files=e,Process={
'base64',
[[dHlwZSB0YWJsZSA9IHsNCiAgICBbYW55XTogYW55DQp9DQoNCnR5cGUgUmVtb3RlRGF0YSA9IHsNCglSZW1vdGU6IEluc3RhbmNlLA0KICAgIE5vQmFja3RyYWNlOiBib29sZWFuPywNCglJc1JlY2VpdmU6IGJvb2xlYW4/LA0KCUFyZ3M6IHRhYmxlLA0KICAgIElkOiBzdHJpbmcsDQoJTWV0aG9kOiBzdHJpbmcsDQogICAgVHJhbnNmZXJUeXBlOiBzdHJpbmcsDQoJVmFsdWVSZXBsYWNlbWVudHM6IHRhYmxlLA0KICAgIFJldHVyblZhbHVlczogdGFibGUsDQogICAgT3JpZ2luYWxGdW5jOiAoSW5zdGFuY2UsIC4uLmFueSkgLT4gLi4uYW55DQp9DQoNCi0tLy8gTW9kdWxlDQpsb2NhbCBQcm9jZXNzID0gew0KICAgIC0tLy8gUmVtb3RlIGNsYXNzZXMNCiAgICBSZW1vdGVDbGFzc0RhdGEgPSB7DQogICAgICAgIFsiUmVtb3RlRXZlbnQiXSA9IHsNCiAgICAgICAgICAgIFNlbmQgPSB7DQogICAgICAgICAgICAgICAgIkZpcmVTZXJ2ZXIiLA0KICAgICAgICAgICAgICAgICJmaXJlU2VydmVyIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBSZWNlaXZlID0gew0KICAgICAgICAgICAgICAgICJPbkNsaWVudEV2ZW50IiwNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgWyJSZW1vdGVGdW5jdGlvbiJdID0gew0KICAgICAgICAgICAgSXNSZW1vdGVGdW5jdGlvbiA9IHRydWUsDQogICAgICAgICAgICBTZW5kID0gew0KICAgICAgICAgICAgICAgICJJbnZva2VTZXJ2ZXIiLA0KICAgICAgICAgICAgICAgICJpbnZva2VTZXJ2ZXIiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIFJlY2VpdmUgPSB7DQogICAgICAgICAgICAgICAgIk9uQ2xpZW50SW52b2tlIiwNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgWyJVbnJlbGlhYmxlUmVtb3RlRXZlbnQiXSA9IHsNCiAgICAgICAgICAgIFNlbmQgPSB7DQogICAgICAgICAgICAgICAgIkZpcmVTZXJ2ZXIiLA0KICAgICAgICAgICAgICAgICJmaXJlU2VydmVyIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBSZWNlaXZlID0gew0KICAgICAgICAgICAgICAgICJPbkNsaWVudEV2ZW50IiwNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgWyJCaW5kYWJsZUV2ZW50Il0gPSB7DQogICAgICAgICAgICBOb1JlY2l2ZUhvb2sgPSB0cnVlLA0KICAgICAgICAgICAgU2VuZCA9IHsNCiAgICAgICAgICAgICAgICAiRmlyZSIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgUmVjZWl2ZSA9IHsNCiAgICAgICAgICAgICAgICAiRXZlbnQiLA0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBbIkJpbmRhYmxlRnVuY3Rpb24iXSA9IHsNCiAgICAgICAgICAgIElzUmVtb3RlRnVuY3Rpb24gPSB0cnVlLA0KICAgICAgICAgICAgTm9SZWNpdmVIb29rID0gdHJ1ZSwNCiAgICAgICAgICAgIFNlbmQgPSB7DQogICAgICAgICAgICAgICAgIkludm9rZSIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgUmVjZWl2ZSA9IHsNCiAgICAgICAgICAgICAgICAiT25JbnZva2UiLA0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSwNCiAgICBSZW1vdGVPcHRpb25zID0ge30sDQogICAgTG9vcGluZ1JlbW90ZXMgPSB7fSwNCiAgICBDb25maWdPdmVyd3JpdGVzID0gew0KICAgICAgICBbeyJzaXJodXJ0IiwgInBvdGFzc2l1bSIsICJ3YXZlIn1dID0gew0KICAgICAgICAgICAgRm9yY2VVc2VDdXN0b21Db21tID0gdHJ1ZQ0KICAgICAgICB9DQogICAgfQ0KfQ0KDQotLS8vIE1vZHVsZXMNCmxvY2FsIEhvb2sNCmxvY2FsIENvbW11bmljYXRpb24NCmxvY2FsIFJldHVyblNwb29mcw0KbG9jYWwgVWkNCmxvY2FsIENvbmZpZw0KDQotLS8vIFNlcnZpY2VzDQpsb2NhbCBIdHRwU2VydmljZTogSHR0cFNlcnZpY2UNCg0KLS0vLyBDb21tdW5pY2F0aW9uIGNoYW5uZWwNCmxvY2FsIENoYW5uZWwNCmxvY2FsIFdyYXBwZWRDaGFubmVsID0gZmFsc2UNCg0KbG9jYWwgU2lnbWFFTlYgPSBnZXRmZW52KDEpDQoNCmZ1bmN0aW9uIFByb2Nlc3M6TWVyZ2UoQmFzZTogdGFibGUsIE5ldzogdGFibGUpDQogICAgaWYgbm90IE5ldyB0aGVuIHJldHVybiBlbmQNCglmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBOZXcgZG8NCgkJQmFzZVtLZXldID0gVmFsdWUNCgllbmQNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkluaXQoRGF0YSkNCiAgICBsb2NhbCBNb2R1bGVzID0gRGF0YS5Nb2R1bGVzDQogICAgbG9jYWwgU2VydmljZXMgPSBEYXRhLlNlcnZpY2VzDQoNCiAgICAtLS8vIFNlcnZpY2VzDQogICAgSHR0cFNlcnZpY2UgPSBTZXJ2aWNlcy5IdHRwU2VydmljZQ0KDQogICAgLS0vLyBNb2R1bGVzDQogICAgQ29uZmlnID0gTW9kdWxlcy5Db25maWcNCiAgICBVaSA9IE1vZHVsZXMuVWkNCiAgICBIb29rID0gTW9kdWxlcy5Ib29rDQogICAgQ29tbXVuaWNhdGlvbiA9IE1vZHVsZXMuQ29tbXVuaWNhdGlvbg0KICAgIFJldHVyblNwb29mcyA9IE1vZHVsZXMuUmV0dXJuU3Bvb2ZzDQplbmQNCg0KLS0vLyBDb21tdW5pY2F0aW9uDQpmdW5jdGlvbiBQcm9jZXNzOlNldENoYW5uZWwoTmV3Q2hhbm5lbDogQmluZGFibGVFdmVudCwgSXNXcmFwcGVkOiBib29sZWFuKQ0KICAgIENoYW5uZWwgPSBOZXdDaGFubmVsDQogICAgV3JhcHBlZENoYW5uZWwgPSBJc1dyYXBwZWQNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkdldENvbmZpZ092ZXJ3cml0ZXMoTmFtZTogc3RyaW5nKQ0KICAgIGxvY2FsIENvbmZpZ092ZXJ3cml0ZXMgPSBzZWxmLkNvbmZpZ092ZXJ3cml0ZXMNCg0KICAgIGZvciBMaXN0LCBPdmVyd3JpdGVzIGluIG5leHQsIENvbmZpZ092ZXJ3cml0ZXMgZG8NCiAgICAgICAgaWYgbm90IHRhYmxlLmZpbmQoTGlzdCwgTmFtZSkgdGhlbiBjb250aW51ZSBlbmQNCiAgICAgICAgcmV0dXJuIE92ZXJ3cml0ZXMNCiAgICBlbmQNCiAgICByZXR1cm4NCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkNoZWNrQ29uZmlnKENvbmZpZzogdGFibGUpDQogICAgbG9jYWwgTmFtZSA9IGlkZW50aWZ5ZXhlY3V0b3IoKTpsb3dlcigpDQoNCiAgICAtLS8vIEZvcmNlIGNvbmZpZ3VyYXRpb24gb3ZlcndyaXRlcyBmb3Igc3BlY2lmaWMgZXhlY3V0b3JzDQogICAgbG9jYWwgT3ZlcndyaXRlcyA9IHNlbGY6R2V0Q29uZmlnT3ZlcndyaXRlcyhOYW1lKQ0KICAgIGlmIG5vdCBPdmVyd3JpdGVzIHRoZW4gcmV0dXJuIGVuZA0KDQogICAgc2VsZjpNZXJnZShDb25maWcsIE92ZXJ3cml0ZXMpDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpDbGVhbkNFcnJvcihFcnJvcjogc3RyaW5nKTogc3RyaW5nDQogICAgRXJyb3IgPSBFcnJvcjpnc3ViKCI6JWQrOiAiLCAiIikNCiAgICBFcnJvciA9IEVycm9yOmdzdWIoIiwgZ290ICVhKyIsICIiKQ0KICAgIEVycm9yID0gRXJyb3I6Z3N1YigiaW52YWxpZCBhcmd1bWVudCIsICJtaXNzaW5nIGFyZ3VtZW50IikNCiAgICByZXR1cm4gRXJyb3INCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkNvdW50TWF0Y2hlcyhTdHJpbmc6IHN0cmluZywgTWF0Y2g6IHN0cmluZyk6IG51bWJlcg0KCWxvY2FsIENvdW50ID0gMA0KCWZvciBfIGluIFN0cmluZzpnbWF0Y2goTWF0Y2gpIGRvDQoJCUNvdW50ICs9MSANCgllbmQNCg0KCXJldHVybiBDb3VudA0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6Q2hlY2tWYWx1ZShWYWx1ZSwgSWdub3JlOiB0YWJsZT8sIENhY2hlOiB0YWJsZT8pDQogICAgbG9jYWwgVHlwZSA9IHR5cGVvZihWYWx1ZSkNCiAgICBDb21tdW5pY2F0aW9uOldhaXRDaGVjaygpDQogICAgDQogICAgaWYgVHlwZSA9PSAidGFibGUiIHRoZW4NCiAgICAgICAgVmFsdWUgPSBzZWxmOkRlZXBDbG9uZVRhYmxlKFZhbHVlLCBJZ25vcmUsIENhY2hlKQ0KICAgIGVsc2VpZiBUeXBlID09ICJJbnN0YW5jZSIgdGhlbg0KICAgICAgICBWYWx1ZSA9IGNsb25lcmVmKFZhbHVlKQ0KICAgIGVuZA0KICAgIA0KICAgIHJldHVybiBWYWx1ZQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6RGVlcENsb25lVGFibGUoVGFibGUsIElnbm9yZTogdGFibGU/LCBWaXNpdGVkOiB0YWJsZT8pOiB0YWJsZQ0KICAgIGlmIHR5cGVvZihUYWJsZSkgfj0gInRhYmxlIiB0aGVuIHJldHVybiBUYWJsZSBlbmQNCiAgICBsb2NhbCBDYWNoZSA9IFZpc2l0ZWQgb3Ige30NCg0KICAgIC0tLy8gQ2hlY2sgZm9yIGNhY2hlZA0KICAgIGlmIENhY2hlW1RhYmxlXSB0aGVuDQogICAgICAgIHJldHVybiBDYWNoZVtUYWJsZV0NCiAgICBlbmQNCg0KICAgIGxvY2FsIE5ldyA9IHt9DQogICAgQ2FjaGVbVGFibGVdID0gTmV3DQoNCiAgICBmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBUYWJsZSBkbw0KICAgICAgICAtLS8vIENoZWNrIGlmIHRoZSB2YWx1ZSBpcyBpZ25vcmVkDQogICAgICAgIGlmIElnbm9yZSBhbmQgdGFibGUuZmluZChJZ25vcmUsIFZhbHVlKSB0aGVuIGNvbnRpbnVlIGVuZA0KICAgICAgICANCiAgICAgICAgS2V5ID0gc2VsZjpDaGVja1ZhbHVlKEtleSwgSWdub3JlLCBDYWNoZSkNCiAgICAgICAgTmV3W0tleV0gPSBzZWxmOkNoZWNrVmFsdWUoVmFsdWUsIElnbm9yZSwgQ2FjaGUpDQogICAgZW5kDQoNCiAgICAtLS8vIE1hc3RlciBjbGVhcg0KICAgIGlmIG5vdCBWaXNpdGVkIHRoZW4NCiAgICAgICAgdGFibGUuY2xlYXIoQ2FjaGUpDQogICAgZW5kDQogICAgDQogICAgcmV0dXJuIE5ldw0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6VW5wYWNrKFRhYmxlOiB0YWJsZSkNCiAgICBpZiBub3QgVGFibGUgdGhlbiByZXR1cm4gVGFibGUgZW5kDQoJbG9jYWwgTGVuZ3RoID0gdGFibGUubWF4bihUYWJsZSkNCglyZXR1cm4gdW5wYWNrKFRhYmxlLCAxLCBMZW5ndGgpDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpQdXNoQ29uZmlnKE92ZXJ3cml0ZXMpDQogICAgc2VsZjpNZXJnZShzZWxmLCBPdmVyd3JpdGVzKQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6RnVuY0V4aXN0cyhOYW1lOiBzdHJpbmcpDQoJcmV0dXJuIFNpZ21hRU5WW05hbWVdDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpDaGVja0V4ZWN1dG9yKCk6IGJvb2xlYW4NCiAgICBsb2NhbCBCbGFja2xpc3RlZCA9IHsNCiAgICAgICAgInhlbm8iLA0KICAgICAgICAic29sYXJhIiwNCiAgICAgICAgImpqc3Bsb2l0Ig0KICAgIH0NCg0KICAgIGxvY2FsIE5hbWUgPSBpZGVudGlmeWV4ZWN1dG9yKCk6bG93ZXIoKQ0KICAgIGxvY2FsIElzQmxhY2tsaXN0ZWQgPSB0YWJsZS5maW5kKEJsYWNrbGlzdGVkLCBOYW1lKQ0KDQogICAgLS0vLyBTb21lIGV4ZWN1dG9ycyBoYXZlIGJyb2tlbiBmdW5jdGlvbmFsaXR5DQogICAgaWYgSXNCbGFja2xpc3RlZCB0aGVuDQogICAgICAgIFVpOlNob3dVbnN1cHBvcnRlZEV4ZWN1dG9yKE5hbWUpDQogICAgICAgIHJldHVybiBmYWxzZQ0KICAgIGVuZA0KDQogICAgcmV0dXJuIHRydWUNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkNoZWNrRnVuY3Rpb25zKCk6IGJvb2xlYW4NCiAgICBsb2NhbCBDb3JlRnVuY3Rpb25zID0gew0KICAgICAgICAiaG9va21ldGFtZXRob2QiLA0KICAgICAgICAiaG9va2Z1bmN0aW9uIiwNCiAgICAgICAgImdldHJhd21ldGF0YWJsZSIsDQogICAgICAgICJzZXRyZWFkb25seSINCiAgICB9DQoNCiAgICAtLS8vIENoZWNrIGlmIHRoZSBmdW5jdGlvbnMgZXhpc3QgaW4gdGhlIEVOVg0KICAgIGZvciBfLCBOYW1lIGluIENvcmVGdW5jdGlvbnMgZG8NCiAgICAgICAgbG9jYWwgRnVuYyA9IHNlbGY6RnVuY0V4aXN0cyhOYW1lKQ0KICAgICAgICBpZiBGdW5jIHRoZW4gY29udGludWUgZW5kDQoNCiAgICAgICAgLS0vLyBGdW5jdGlvbiBtaXNzaW5nIQ0KICAgICAgICBVaTpTaG93VW5zdXBwb3J0ZWQoTmFtZSkNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgZW5kDQoNCiAgICByZXR1cm4gdHJ1ZQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6Q2hlY2tJc1N1cHBvcnRlZCgpOiBib29sZWFuDQogICAgLS0vLyBDaGVjayBpZiB0aGUgZXhlY3V0b3IgaXMgYmxhY2tsaXN0ZWQNCiAgICBsb2NhbCBFeGVjdXRvclN1cHBvcnRlZCA9IHNlbGY6Q2hlY2tFeGVjdXRvcigpDQogICAgaWYgbm90IEV4ZWN1dG9yU3VwcG9ydGVkIHRoZW4NCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgZW5kDQoNCiAgICAtLS8vIENoZWNrIGlmIHRoZSBjb3JlIGZ1bmN0aW9ucyBleGlzdA0KICAgIGxvY2FsIEZ1bmN0aW9uc1N1cHBvcnRlZCA9IHNlbGY6Q2hlY2tGdW5jdGlvbnMoKQ0KICAgIGlmIG5vdCBGdW5jdGlvbnNTdXBwb3J0ZWQgdGhlbg0KICAgICAgICByZXR1cm4gZmFsc2UNCiAgICBlbmQNCg0KICAgIHJldHVybiB0cnVlDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpHZXRDbGFzc0RhdGEoUmVtb3RlOiBJbnN0YW5jZSk6IHRhYmxlPw0KICAgIGxvY2FsIFJlbW90ZUNsYXNzRGF0YSA9IHNlbGYuUmVtb3RlQ2xhc3NEYXRhDQogICAgbG9jYWwgQ2xhc3NOYW1lID0gSG9vazpJbmRleChSZW1vdGUsICJDbGFzc05hbWUiKQ0KDQogICAgcmV0dXJuIFJlbW90ZUNsYXNzRGF0YVtDbGFzc05hbWVdDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpJc1Byb3RlY3RlZFJlbW90ZShSZW1vdGU6IEluc3RhbmNlKTogYm9vbGVhbg0KICAgIGxvY2FsIElzRGVidWcgPSBSZW1vdGUgPT0gQ29tbXVuaWNhdGlvbi5EZWJ1Z0lkUmVtb3RlDQogICAgbG9jYWwgSXNDaGFubmVsID0gUmVtb3RlID09IChXcmFwcGVkQ2hhbm5lbCBhbmQgQ2hhbm5lbC5DaGFubmVsIG9yIENoYW5uZWwpDQoNCiAgICByZXR1cm4gSXNEZWJ1ZyBvciBJc0NoYW5uZWwNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOlJlbW90ZUFsbG93ZWQoUmVtb3RlOiBJbnN0YW5jZSwgVHJhbnNmZXJUeXBlOiBzdHJpbmcsIE1ldGhvZDogc3RyaW5nPyk6IGJvb2xlYW4/DQogICAgaWYgdHlwZW9mKFJlbW90ZSkgfj0gJ0luc3RhbmNlJyB0aGVuIHJldHVybiBlbmQNCiAgICANCiAgICAtLS8vIENoZWNrIGlmIHRoZSBSZW1vdGUgaXMgcHJvdGVjdGVkDQogICAgaWYgc2VsZjpJc1Byb3RlY3RlZFJlbW90ZShSZW1vdGUpIHRoZW4gcmV0dXJuIGVuZA0KDQogICAgLS0vLyBGZXRjaCBjbGFzcyB0YWJsZQ0KCWxvY2FsIENsYXNzRGF0YSA9IHNlbGY6R2V0Q2xhc3NEYXRhKFJlbW90ZSkNCglpZiBub3QgQ2xhc3NEYXRhIHRoZW4gcmV0dXJuIGVuZA0KDQogICAgLS0vLyBDaGVjayBpZiB0aGUgdHJhbnNmZXIgdHlwZSBoYXMgZGF0YQ0KCWxvY2FsIEFsbG93ZWQgPSBDbGFzc0RhdGFbVHJhbnNmZXJUeXBlXQ0KCWlmIG5vdCBBbGxvd2VkIHRoZW4gcmV0dXJuIGVuZA0KDQogICAgLS0vLyBDaGVjayBpZiB0aGUgbWV0aG9kIGlzIGFsbG93ZWQNCglpZiBNZXRob2QgdGhlbg0KCQlyZXR1cm4gdGFibGUuZmluZChBbGxvd2VkLCBNZXRob2QpIH49IG5pbA0KCWVuZA0KDQoJcmV0dXJuIHRydWUNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOlNldEV4dHJhRGF0YShEYXRhOiB0YWJsZSkNCiAgICBpZiBub3QgRGF0YSB0aGVuIHJldHVybiBlbmQNCiAgICBzZWxmLkV4dHJhRGF0YSA9IERhdGENCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkdldFJlbW90ZVNwb29mKFJlbW90ZTogSW5zdGFuY2UsIE1ldGhvZDogc3RyaW5nLCAuLi4pOiB0YWJsZT8NCiAgICBsb2NhbCBTcG9vZiA9IFJldHVyblNwb29mc1tSZW1vdGVdDQoNCiAgICBpZiBub3QgU3Bvb2YgdGhlbiByZXR1cm4gZW5kDQogICAgaWYgU3Bvb2YuTWV0aG9kIH49IE1ldGhvZCB0aGVuIHJldHVybiBlbmQNCg0KICAgIGxvY2FsIFJldHVyblZhbHVlcyA9IFNwb29mLlJldHVybg0KDQogICAgLS0vLyBDYWxsIHRoZSBSZXR1cm5WYWx1ZXMgZnVuY3Rpb24gdHlwZQ0KICAgIGlmIHR5cGVvZihSZXR1cm5WYWx1ZXMpID09ICJmdW5jdGlvbiIgdGhlbg0KICAgICAgICBSZXR1cm5WYWx1ZXMgPSBSZXR1cm5WYWx1ZXMoLi4uKQ0KICAgIGVuZA0KDQoJcmV0dXJuIFJldHVyblZhbHVlcw0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6U2V0TmV3UmV0dXJuU3Bvb2ZzKE5ld1JldHVyblNwb29mczogdGFibGUpDQogICAgUmV0dXJuU3Bvb2ZzID0gTmV3UmV0dXJuU3Bvb2ZzDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpGaW5kQ2FsbGluZ0xDbG9zdXJlKE9mZnNldDogbnVtYmVyKQ0KICAgIGxvY2FsIEdldGZlbnYgPSBIb29rOkdldE9yaWdpbmFsRnVuYyhnZXRmZW52KQ0KICAgIE9mZnNldCArPSAxDQoNCiAgICB3aGlsZSB0cnVlIGRvDQogICAgICAgIE9mZnNldCArPSAxDQoNCiAgICAgICAgLS0vLyBDaGVjayBpZiB0aGUgc3RhY2sgbGV2ZWwgaXMgdmFsaWQNCiAgICAgICAgbG9jYWwgSXNWYWxpZCA9IGRlYnVnLmluZm8oT2Zmc2V0LCAibCIpIH49IC0xDQogICAgICAgIGlmIG5vdCBJc1ZhbGlkIHRoZW4gY29udGludWUgZW5kDQoNCiAgICAgICAgLS0vLyBDaGVjayBpZiB0aGUgZnVuY3Rpb24gaXMgdmFsaWQNCiAgICAgICAgbG9jYWwgRnVuY3Rpb24gPSBkZWJ1Zy5pbmZvKE9mZnNldCwgImYiKQ0KICAgICAgICBpZiBub3QgRnVuY3Rpb24gdGhlbiByZXR1cm4gZW5kDQogICAgICAgIGlmIEdldGZlbnYoRnVuY3Rpb24pID09IFNpZ21hRU5WIHRoZW4gY29udGludWUgZW5kDQoNCiAgICAgICAgcmV0dXJuIEZ1bmN0aW9uDQogICAgZW5kDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpEZWNvbXBpbGUoU2NyaXB0OiBMb2NhbFNjcmlwdCB8IE1vZHVsZVNjcmlwdCk6IHN0cmluZw0KICAgIGxvY2FsIEtvbnN0YW50QVBJID0gImh0dHA6Ly9hcGkucGx1c2dpYW50NS5jb20va29uc3RhbnQvZGVjb21waWxlIg0KICAgIGxvY2FsIEZvcmNlS29uc3RhbnQgPSBDb25maWcgYW5kIENvbmZpZy5Gb3JjZUtvbnN0YW50RGVjb21waWxlciBvciBmYWxzZQ0KDQogICAgLS0vLyBVc2UgYnVpbHQtaW4gZGVjb21waWxlciBpZiB0aGUgZXhlY3V0b3Igc3VwcG9ydHMgaXQNCiAgICBpZiBkZWNvbXBpbGUgYW5kIG5vdCBGb3JjZUtvbnN0YW50IHRoZW4gDQogICAgICAgIHJldHVybiBkZWNvbXBpbGUoU2NyaXB0KQ0KICAgIGVuZA0KDQogICAgLS0vLyBnZXRzY3JpcHRieXRlY29kZQ0KICAgIGxvY2FsIFN1Y2Nlc3MsIEJ5dGVjb2RlID0gcGNhbGwoZ2V0c2NyaXB0Ynl0ZWNvZGUsIFNjcmlwdCkNCiAgICBpZiBub3QgU3VjY2VzcyB0aGVuDQogICAgICAgIGxvY2FsIEVycm9yID0gYC0tRmFpbGVkIHRvIGdldCBzY3JpcHQgYnl0ZWNvZGUsIGVycm9yOlxuYA0KICAgICAgICBFcnJvciAuLj0gYFxuLS1bW1xue0J5dGVjb2RlfVxuXV1gDQogICAgICAgIHJldHVybiBFcnJvciwgdHJ1ZQ0KICAgIGVuZA0KICAgIA0KICAgIC0tLy8gU2VuZCBQT1NUIHJlcXVlc3QgdG8gdGhlIEFQSQ0KICAgIGxvY2FsIFJlc3BvbmNlID0gcmVxdWVzdCh7DQogICAgICAgIFVybCA9IEtvbnN0YW50QVBJLA0KICAgICAgICBCb2R5ID0gQnl0ZWNvZGUsDQogICAgICAgIE1ldGhvZCA9ICJQT1NUIiwNCiAgICAgICAgSGVhZGVycyA9IHsNCiAgICAgICAgICAgIFsiQ29udGVudC1UeXBlIl0gPSAidGV4dC9wbGFpbiINCiAgICAgICAgfSwNCiAgICB9KQ0KDQogICAgLS0vLyBFcnJvciBjaGVjaw0KICAgIGlmIFJlc3BvbmNlLlN0YXR1c0NvZGUgfj0gMjAwIHRoZW4NCiAgICAgICAgbG9jYWwgRXJyb3IgPSBgLS1bS09OU1RBTlRdIEVycm9yIG9jY3VyZWQgd2hpbGUgcmVxdWVzdGluZyB0aGUgQVBJLCBlcnJvcjpcbmANCiAgICAgICAgRXJyb3IgLi49IGBcbi0tW1tcbntSZXNwb25jZS5Cb2R5fVxuXV1gDQogICAgICAgIHJldHVybiBFcnJvciwgdHJ1ZQ0KICAgIGVuZA0KDQogICAgcmV0dXJuIFJlc3BvbmNlLkJvZHkNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkdldFNjcmlwdEZyb21GdW5jKEZ1bmM6ICguLi5hbnkpIC0+IC4uLmFueSkNCiAgICBpZiBub3QgRnVuYyB0aGVuIHJldHVybiBlbmQNCg0KICAgIGxvY2FsIFN1Y2Nlc3MsIEVOViA9IHBjYWxsKGdldGZlbnYsIEZ1bmMpDQogICAgaWYgbm90IFN1Y2Nlc3MgdGhlbiByZXR1cm4gZW5kDQogICAgDQogICAgLS0vLyBCbGFja2xpc3Qgc2lnbWEgc3B5DQogICAgaWYgc2VsZjpJc1NpZ21hU3B5RU5WKEVOVikgdGhlbiByZXR1cm4gZW5kDQoNCiAgICByZXR1cm4gcmF3Z2V0KEVOViwgInNjcmlwdCIpDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpDb25uZWN0aW9uSXNWYWxpZChDb25uZWN0aW9uOiB0YWJsZSk6IGJvb2xlYW4NCiAgICBsb2NhbCBWYWx1ZVJlcGxhY2VtZW50cyA9IHsNCgkJWyJTY3JpcHQiXSA9IGZ1bmN0aW9uKENvbm5lY3Rpb246IHRhYmxlKTogU2NyaXB0Pw0KCQkJbG9jYWwgRnVuY3Rpb24gPSBDb25uZWN0aW9uLkZ1bmN0aW9uDQoJCQlpZiBub3QgRnVuY3Rpb24gdGhlbiByZXR1cm4gZW5kDQoNCgkJCXJldHVybiBzZWxmOkdldFNjcmlwdEZyb21GdW5jKEZ1bmN0aW9uKQ0KCQllbmQNCgl9DQoNCiAgICAtLS8vIENoZWNrIGlmIHRoZXNlIHByb3BlcnRpZXMgYXJlIHZhbGlkDQogICAgbG9jYWwgVG9DaGVjayA9IHsNCiAgICAgICAgIlNjcmlwdCINCiAgICB9DQogICAgZm9yIF8sIFByb3BlcnR5IGluIFRvQ2hlY2sgZG8NCiAgICAgICAgbG9jYWwgUmVwbGFjZW1lbnQgPSBWYWx1ZVJlcGxhY2VtZW50c1tQcm9wZXJ0eV0NCiAgICAgICAgbG9jYWwgVmFsdWUNCg0KICAgICAgICAtLS8vIENoZWNrIGlmIHRoZXJlJ3MgYSBmdW5jdGlvbiBmb3IgYSBwcm9wZXJ0eQ0KICAgICAgICBpZiBSZXBsYWNlbWVudCB0aGVuDQogICAgICAgICAgICBWYWx1ZSA9IFJlcGxhY2VtZW50KENvbm5lY3Rpb24pDQogICAgICAgIGVuZA0KDQogICAgICAgIC0tLy8gQ2hlY2sgaWYgdGhlIHByb3BlcnR5IGhhcyBhIHZhbHVlDQogICAgICAgIGlmIFZhbHVlID09IG5pbCB0aGVuIA0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlIA0KICAgICAgICBlbmQNCiAgICBlbmQNCg0KICAgIHJldHVybiB0cnVlDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpGaWx0ZXJDb25uZWN0aW9ucyhTaWduYWw6IFJCWFNjcmlwdFNpZ25hbCk6IHRhYmxlDQogICAgbG9jYWwgUHJvY2Vzc2VkID0ge30NCg0KICAgIC0tLy8gRmlsdGVyIGVhY2ggY29ubmVjdGlvbg0KICAgIGZvciBfLCBDb25uZWN0aW9uIGluIGdldGNvbm5lY3Rpb25zKFNpZ25hbCkgZG8NCiAgICAgICAgaWYgbm90IHNlbGY6Q29ubmVjdGlvbklzVmFsaWQoQ29ubmVjdGlvbikgdGhlbiBjb250aW51ZSBlbmQNCiAgICAgICAgdGFibGUuaW5zZXJ0KFByb2Nlc3NlZCwgQ29ubmVjdGlvbikNCiAgICBlbmQNCg0KICAgIHJldHVybiBQcm9jZXNzZWQNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOklzU2lnbWFTcHlFTlYoRW52OiB0YWJsZSk6IGJvb2xlYW4NCiAgICByZXR1cm4gRW52ID09IFNpZ21hRU5WDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpHZXRSZW1vdGVEYXRhKElkOiBzdHJpbmcpDQogICAgbG9jYWwgUmVtb3RlT3B0aW9ucyA9IHNlbGYuUmVtb3RlT3B0aW9ucw0KDQogICAgLS0vLyBDaGVjayBmb3IgZXhp
